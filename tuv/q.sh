#!/bin/bash
m=04

# vics list:
# curl 'https://www.tuv.com/tos-pti-relaunch-2019/rest/ajax/getMergedLocationsByGeo'   -H 'authority: www.tuv.com'   -H 'accept: application/json, text/javascript, */*; q=0.01'   -H 'accept-language: en-GB,en-US;q=0.9,en;q=0.8'   -H 'content-type: application/json; charset=UTF-8'   -H 'cookie: JSESSIONID=AEE437088A5A9622FF7CFD26E5D43253; CookieConsent={stamp:%27EZvYyLaNt315fJidXcH5c8MJjhx5ygoJU0pM14zGY2P0LSUGFn5wJQ==%27%2Cnecessary:true%2Cpreferences:true%2Cstatistics:true%2Cmarketing:true%2Cmethod:%27explicit%27%2Cver:2%2Cutc:1679594494717%2Cregion:%27de%27}; _gcl_au=1.1.900591059.1679594495; _fbp=fb.1.1679594495157.618057127; wt3_eid=%3B350258498646185%7C2167959449573133083%232167959449570883482; wt3_sid=%3B350258498646185; ln_or=eyIxMTgzOTMyIjoiZCJ9; ELOQUA=GUID=2C4C176D017443B6BABDEFCBCA34E975; JSESSIONID=B19591CB60CBFB5D4EE7E39CCE1EA895; wt_rla=350258498646185%2C18%2C1679604277133'   -H 'origin: https://www.tuv.com'   -H 'referer: https://www.tuv.com/germany/de/termin-f%C3%BChrerschein/'   -H 'sec-ch-ua: "Google Chrome";v="111", "Not(A:Brand";v="8", "Chromium";v="111"'   -H 'sec-ch-ua-mobile: ?0'   -H 'sec-ch-ua-platform: "macOS"'   -H 'sec-fetch-dest: empty'   -H 'sec-fetch-mode: cors'   -H 'sec-fetch-site: same-origin'   -H 'user-agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/111.0.0.0 Safari/537.36'   -H 'x-requested-with: XMLHttpRequest'   --data-raw '{"locale":"de-DE","isLegacyTos":false,"limit":30,"location":{"latitude":50.7419457,"longitude":7.0950367},"radius":200,"vehicleService":{"id":0},"vehicleType":{"id":44}}'   --compressed | jq '.vics[].id' | sort | uniq



for d in $(seq 1 30); do

curl 'https://www.tuv.com/tos-pti-relaunch-2019/rest/ajax/getVacanciesByDay'   -H 'authority: www.tuv.com'   -H 'accept: application/json, text/javascript, */*; q=0.01'   -H 'accept-language: en-GB,en-US;q=0.9,en;q=0.8'   -H 'content-type: application/json; charset=UTF-8'   -H 'cookie: JSESSIONID=AEE437088A5A9622FF7CFD26E5D43253; CookieConsent={stamp:%27EZvYyLaNt315fJidXcH5c8MJjhx5ygoJU0pM14zGY2P0LSUGFn5wJQ==%27%2Cnecessary:true%2Cpreferences:true%2Cstatistics:true%2Cmarketing:true%2Cmethod:%27explicit%27%2Cver:2%2Cutc:1679594494717%2Cregion:%27de%27}; _gcl_au=1.1.900591059.1679594495; _fbp=fb.1.1679594495157.618057127; wt3_eid=%3B350258498646185%7C2167959449573133083%232167959449570883482; wt3_sid=%3B350258498646185; ln_or=eyIxMTgzOTMyIjoiZCJ9; ELOQUA=GUID=2C4C176D017443B6BABDEFCBCA34E975; JSESSIONID=B19591CB60CBFB5D4EE7E39CCE1EA895; wt_rla=350258498646185%2C52%2C1679601927525'   -H 'origin: https://www.tuv.com'   -H 'referer: https://www.tuv.com/germany/de/termin-f%C3%BChrerschein/'   -H 'sec-ch-ua: "Google Chrome";v="111", "Not(A:Brand";v="8", "Chromium";v="111"'   -H 'sec-ch-ua-mobile: ?0'   -H 'sec-ch-ua-platform: "macOS"'   -H 'sec-fetch-dest: empty'   -H 'sec-fetch-mode: cors'   -H 'sec-fetch-site: same-origin'   -H 'user-agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/111.0.0.0 Safari/537.36'   -H 'x-requested-with: XMLHttpRequest'   --data-raw '{"locale":"de-DE","isLegacyTos":false,"date":{"date":"2023-04-26"},"vehicleServices":[{"id":4007}],"vehicleType":{"id":44},"vics":[{"id":407,"externalLocale":"de-DE","distance":1},{"id":406,"externalLocale":"de-DE","distance":8},{"id":392,"externalLocale":"de-DE","distance":13},{"id":408,"externalLocale":"de-DE","distance":19}]}'   --compressed | jq '.timetables[].timeRangeVacancies[].timeslots[] | select(.availableDates | length > 0)'

done
